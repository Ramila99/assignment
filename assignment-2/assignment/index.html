<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href='http://fonts.googleapis.com/css?family=Dosis:400,700,500|Nunito:300,400,600' />
    <link rel="stylesheet" href="style.css">
    <script src="https://code.iconify.design/1/1.0.7/iconify.min.js"></script>
    <title>Movies</title>

</head>

<body>
    <div class="container">
        <h1 id="name">user</h1>
    </div>
    <div class="flex">
        <div class="movie-info card">
            <div class=" flex-1">
                <img class="padlef" src="images/Interstellar.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">Interstellar</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>8.4</span> /10</p>
                </div>
            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="Interstellar"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/slider2.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">Into the Wild (2007)</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>7.2</span> /10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="Wild"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/slider3.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">Blade Runner 2049</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>7.4</span> /10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="2049"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/slider4.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">Mulholland Drive</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>8</span>/10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="Mulholland Drive"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/Guardians.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">Guardians of the Galaxy</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>7.7</span>/10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="Guardians of the Galaxy"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/it.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">IT</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>6.3</span>/10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="IT"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/skyfall.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">SkyFall</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>8.3</span>/10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="SkyFall"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/theforest.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">The Forest</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>4.3</span>/10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="The Forest"></div>
        </div>
        <div class="movie-info card">
            <div class="flex-1">
                <img class="padlef" src="images/harrypoter.jpg" alt="" width="185" height="237">

                <div class="title-in">
                    <h1><a href="#">HarryPotter& Sorcerer's Stone</a></h1>
                    <p><i class="iconify" data-icon="ion-md-star" data-inline="false"></i><span>8.5</span>/10</p>
                </div>

            </div>
            <div class="flex heading">
                <h2>User Reviews</h2> <button class="add">add</button>
            </div>
            <div class="content" id="Harry Poter"></div>
        </div>
    </div>
    <div class="addcomment">
        <div class="input">
            <button id="close">&times;</button>
            <h2>Add Comments</h2>
            <div>
                <input type="number" id="star" name="star" placeholder="star" maxlength="1">
                <input type="text" id="til" name="title" placeholder="Title">
                <input type="text" id="com" name="comment" placeholder="Comments">
                <input type="submit" value="Post" name="submit" id="submit">
                <input name="name" class="hide">
                <input name="movie" class="hide">
                <input name="date" class="hide">
            </div>
        </div>

    </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="script.js"></script>
    <script>
       
    </script>



    <script>//localStorage.removeItem( 'name' ); // Clear the localStorage
     $('#star').on('keyup', ()=>{
            let val= $('#star').val();
            console.log(val)
           if(val > 0 && val<6 && val!='')
           { return true}
           else{
            alert("invali number")
            $('#star').val(null);
           }
               
        });
        const name = localStorage['name'];
        document.getElementById('name').innerHTML = name;
        $('.movie-info').on("click", function () {
            const movie = $(this).find(".title-in h1 a").html()


            $(".add").on("click", (function (e) {
                e.preventDefault();

                $('.addcomment').css('display', 'block');

                $("#close").on("click", (function () {
                    $('.addcomment').css('display', 'none');
                }));

                const mainContainer = $(this).parent('div');

                const comment = newComment();

                comment[4].addEventListener('click', () => {
                    const json = {
                        'movie': movie,
                        'rate': comment[1].value,
                        'name': name,
                        'title': comment[2].value,
                        'date': comment[0],
                        'comment': comment[3].value
                    }
                localStorage.setItem("object", JSON.stringify(json));

                const data = localStorage['object'];
                $('.addcomment').css('display', 'none');
                $(this).css('display', 'none');
                    
                const obj = elements();
                const user_comment = obj[0]; 
                const star = obj[1];
                const star1 = obj[2];
                const sta = obj[3];
                const strong = obj[4];
                const comment_meta = obj[5];
                const date1 = obj[6];
                const name1 = obj[7];
                const description = obj[8];
                const pad = obj[9];
                
                sta.text(comment[1].value);
                strong.text(comment[2].value); 
                date1.text(comment[0]);
                name1.text(name);
                pad.text(comment[3].value);                


                star1.appendTo(star);
                sta.appendTo(star);
                star.appendTo(user_comment);
                strong.appendTo(user_comment);
                date1.appendTo(comment_meta);
                name1.appendTo(comment_meta);
                comment_meta.appendTo(user_comment);
                pad.appendTo(description);
                description.appendTo(comment_meta);
                // $('<hr>').appendTo(comment_meta);
                user_comment.appendTo(mainContainer);

                    
                       $.ajax({
                        url: './index.php',
                        type: 'POST',
                        data: {
                            name: name,
                            date: comment[0],
                            movie: movie,
                            star: comment[1].value,
                            title: comment[2].value,
                            comment: comment[3].value
                        },
                        // catch:alert("fail"),
                        success: function () {
                            alert('Email Sent');
                            return true;
                        }
                    });
                    for(let i=0 ;i<4;i++ )
                    comment[i].value=null;
                    localStorage.clear();
                });
            }));
           
        });
    

    </script>
</body>

</html>